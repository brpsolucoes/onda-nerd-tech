{% load i18n %} {% load static %}
{% with request.resolver_match.url_name as path_name %}

<nav class="navbar navbar-light">
    <div class="navbar-left">
        <div class="logo-area">
            <a class="navbar-brand" href="#">
                {% if active_company.name %}
                    {{ active_company.name }} 
                {% else %}
                    Onda Nerd 
                {% endif %}
            </a>
            <a href="#" class="sidebar-toggle">
                <img
                    class="svg"
                    src="{% static 'img/svg/align-center-alt.svg' %}"
                    alt="img"
            /></a>
        </div>
        <div class="top-menu">
            <div class="hexadash-top-menu position-relative">
                <ul>
                    <li class="has-subMenu">
                        <a
                            href="#"
                            class="{% if '/dashboard/' in request.path %}active{% endif %}"
                        >
                            <span class="menu-text"
                                >{% translate "dashboard-menu-title" %}</span
                            >
                        </a>
                        <ul class="subMenu">
                            <li>
                                <a
                                    class="{% if path_name == 'demo_one' %}active{% endif %}"
                                    href="{% url 'shared:dashboard' %}"
                                    >{% translate "dashboard-demo-one" %}</a
                                >
                            </li>
                        </ul>
                    </li>
                    <li class="has-subMenu">
                        <a href="#" class="">Layouts</a>
                        <ul class="subMenu">
                            <li class="l_sidebar">
                                <a href="#" data-layout="light">Light Mode</a>
                            </li>
                            <li class="l_sidebar">
                                <a href="#" data-layout="dark">Dark Mode</a>
                            </li>
                            <li class="l_navbar">
                                <a href="#" data-layout="side">Side Menu</a>
                            </li>
                        </ul>
                    </li>
                </ul>
            </div>
        </div>
    </div>
    <div class="navbar-right">
        <ul class="navbar-right__menu">
            <li class="nav-flag-select">
                {% if user.is_authenticated and user_companies.count > 1 %}
                    <li class="nav-item d-flex align-items-center me-3">
                        <select 
                            class="form-select form-select-sm" 
                            aria-label="Selecionar Empresa"
                            onchange="window.location.href = this.value;"
                        >
                            <option value="" disabled selected>
                                Empresa Ativa: {{ active_company.name|default:"Selecione" }}
                            </option>
                            {% for company in user_companies %}
                                <option value="{% url 'accounts:switch_company' company_pk=company.pk %}"
                                    {% if company.pk == active_company_id %}selected{% endif %}>
                                    {{ company.name }}
                                </option>
                            {% endfor %}
                        </select>
                    </li>
                {% endif %}
                <div class="dropdown-custom">
                    {% if request.LANGUAGE_CODE == 'en' %}
                    <a href="javascript:;" class="nav-item-toggle"
                        ><img
                            src="{% static 'img/eng.png' %}"
                            alt=""
                            class="rounded-circle"
                    /></a>
                    {% elif request.LANGUAGE_CODE == 'de' %}
                    <a href="javascript:;" class="nav-item-toggle"
                        ><img
                            src="{% static 'img/ger.png' %}"
                            alt=""
                            class="rounded-circle"
                    /></a>
                    {% elif request.LANGUAGE_CODE == 'ar' %}
                    <a href="javascript:;" class="nav-item-toggle"
                        ><img
                            src="{% static 'img/iraq.png' %}"
                            alt=""
                            class="rounded-circle"
                    /></a>
                    {% endif %}
                    <div class="dropdown-parent-wrapper">
                        <div class="dropdown-wrapper dropdown-wrapper--small">
                            {% get_current_language as LANGUAGE_CODE %} {%
                            get_available_languages as LANGUAGES %} {%
                            get_language_info_list for LANGUAGES as languages %}
                            {% for lang in languages %}
                            <a
                                href="/{{ lang.code }}{{ request.get_full_path|slice:'3:' }}"
                            >
                                {% if lang.code == 'en' %}
                                <img src="{% static 'img/eng.png' %}" alt="" />
                                {% elif lang.code == 'de' %}
                                <img src="{% static 'img/ger.png' %}" alt="" />
                                {% elif lang.code == 'ar' %}
                                <img src="{% static 'img/iraq.png' %}" alt="" />
                                {% endif %} {{ lang.name_local }}
                            </a>
                            {% endfor %}
                        </div>
                    </div>
                </div>
            </li>
            <li class="nav-author">
                {% if user.is_authenticated %}
                <div class="dropdown-custom">
                    <a href="javascript:;" class="nav-item-toggle"
                        ><img
                            src="{% static 'img/author-nav.jpg' %}"
                            alt=""
                            class="rounded-circle"
                        />
                        <span class="nav-item__title"
                            >{{ user.get_full_name }}<i
                                class="las la-angle-down nav-item__arrow"
                            ></i
                        ></span>
                    </a>
                    <div class="dropdown-parent-wrapper">
                        <div class="dropdown-wrapper">
                            <div class="nav-author__info">
                                <div class="author-img">
                                    <img
                                        src="{% static 'img/author-nav.jpg' %}"
                                        alt=""
                                        class="rounded-circle"
                                    />
                                </div>
                                <div>
                                    <h6>{{ user.get_full_name }}</h6>
                                    <span>Developer</span>
                                </div>
                            </div>
                            <div class="nav-author__options">
                                <ul>
                                    <li>
                                        <a href="">
                                            <img
                                                src="{% static 'img/svg/user.svg' %}"
                                                alt="user"
                                                class="svg"
                                            />
                                            Profile</a
                                        >
                                    </li>
                                    <li>
                                        <a href="{% url 'accounts:settings' %}">
                                            <img
                                                src="{% static 'img/svg/settings.svg' %}"
                                                alt="setting"
                                                class="svg"
                                            />
                                            Configurações
                                        </a>
                                    </li>
                                </ul>
                                <form action="{% url "accounts:logout" %}" method="post">
                                    {% csrf_token %}
                                    <a class="text-link nav-author__signout">
                                        <button type="submit" class="btn btn-dark btn-sm">
                                            Sair
                                        </button>
                                    </a>
                                </form>
                            </div>
                        </div>
                    </div>
                </div>
                {% endif %}
            </li>
        </ul>
        <div class="navbar-right__mobileAction d-md-none">
            <a href="#" class="btn-search">
                <img
                    src="{% static 'img/svg/search.svg' %}"
                    alt="search"
                    class="svg feather-search" />
                <img
                    src="{% static 'img/svg/x.svg' %}"
                    alt="x"
                    class="svg feather-x"
            /></a>
            <a href="#" class="btn-author-action">
                <img
                    class="svg"
                    src="{% static 'img/svg/more-vertical.svg' %}"
                    alt="more-vertical"
            /></a>
        </div>
    </div>
</nav>
{% endwith %}
